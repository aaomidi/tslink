# Example: Web server with Tailscale Serve (HTTPS)
#
# This gives your container a Tailscale identity with automatic HTTPS.
# Access via: https://web-server.<tailnet-name>.ts.net
#
# Usage:
#   export TS_AUTHKEY=tskey-auth-xxx
#   docker-compose up -d
#
# Note: Use :main-arm64 or :main-amd64 depending on your architecture

networks:
  tailnet:
    driver: ghcr.io/aaomidi/tslink:main-arm64
    driver_opts:
      ts.authkey: ${TS_AUTHKEY}

services:
  web:
    image: nginx:alpine
    networks:
      - tailnet
    labels:
      ts.hostname: "web-server"
      ts.serve.443: "https:80"  # HTTPS on 443 -> container port 80
